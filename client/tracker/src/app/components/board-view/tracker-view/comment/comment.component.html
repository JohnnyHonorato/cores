<div id="comments" *ngIf="trackerId">
    <div class="card border-0">
        <div class="card-header-comments d-flex align-items-center cursor-pointer py-2 mt-0 px-3"
             data-bs-toggle="collapse" href="#collapse-comment" aria-expanded="false">
            <div id="card-update-header" class="page-title-wizard">{{'tracker.card.updates' | translate}}</div>
            <div class="ms-auto">
                <i id="less-icon" class="material-icons-outlined expand_less"> expand_less </i>
                <i id="more-icon" class="material-icons-outlined expand_more"> expand_more </i>
            </div>
        </div>
        <div class="card-body collapse p-0 px-3" id="collapse-comment">
            <common-loading id="loading-comment" [loading]="loading"></common-loading>
            <div *ngIf="items.length && !loading" class="mt-2">
                <div *ngFor="let item of items">
                    <div class="card col-12 p-0 mb-2">
                        <div class="card-header d-flex align-items-center justify-content-between px-2">
                            <label id="user-label" *ngIf="!item.systemLog; else systemLog"
                                   class="m-0 comment-title">{{item.user}}</label>
                            <ng-template #systemLog>
                                <label id="system-log"></label>
                            </ng-template>
                            <div class="card-options">
                                <label id="created-on-label"
                                       class="custom-label">{{item.createdOn | date:'dd/MM/yyyy - hh:mm'}}</label>
                                <div class="btn-group">
                                    <button id="drop-down-button" type="button"
                                            class="btn-muted p-0"
                                            data-bs-toggle="dropdown"
                                            [disabled]="item.autoGenerated || userName!==item.username">
                                        <span id="options-icon" class="material-icons custom-icon"> more_vert </span>
                                    </button>
                                    <ul class="dropdown-menu py-1" role="menu">
                                        <li id="edit-comment"
                                            class="p-0 cursor-pointer comment-option d-flex align-items-center px-3 py-1"
                                            (click)="edit(item)">
                                            <span id="edit-icon" class="material-icons fs-6 me-1"> edit </span>
                                            {{'system.edit' | translate}}
                                        </li>
                                        <li id="delete-comment"
                                            class="p-0 cursor-pointer comment-option d-flex align-items-center px-3 py-1"
                                            (click)="remove(item.id)" data-bs-toggle="modal"
                                            data-bs-target="#modal-delete">
                                            <span id="delete-icon" class="material-icons fs-6 me-1"> delete </span>
                                            {{'system.delete' | translate}}
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div id="comment-content" class="card-body px-2">
                            {{item.text}}
                        </div>
                        <common-delete-confirmation id="delete-confirmation" target="modal-delete"></common-delete-confirmation>
                    </div>
                </div>
            </div>
            <div class="d-flex align-items-center justify-content-between" *ngIf="items.length">
                <common-page-size id="comment-page-size" [itemsPerPage]="[5, 10, 15]" (pageSizeChanged)="setPageSize($event)">
                </common-page-size>
                <common-paginator id="comment-total-pages" [totalPages]="totalPages" (pageChanged)="onChangePaginator($event)">
                </common-paginator>
            </div>
            <h5 id="insert-comment-label" class="title text custom-title">{{'tracker.card.insert-comment' | translate}}</h5>
            <div class="form-group p-0">
                <textarea id="text-area" rows="2" class="form-control textarea-custom" [(ngModel)]="comment.text"
                          [maxlength]="5000">
                </textarea>
                <button id="save" [disabled]="!comment.text" class="btn btn-primary btn-sm custom-button-textarea"
                        (click)="save()" translate>
                    tracker.card.to-comment
                </button>
            </div>
        </div>
    </div>
</div>

